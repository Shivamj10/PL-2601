Module 4: Jenkins | Day 14 | 23-01-2025
============================================================================================================
Installation of Jenkins
------------------------------------------
https://www.jenkins.io/doc/book/installing/linux/

sudo dnf install -y java-21-amazon-corretto-devel
sudo wget -O /etc/yum.repos.d/jenkins.repo \
    https://pkg.jenkins.io/redhat-stable/jenkins.repo
sudo rpm --import https://pkg.jenkins.io/redhat-stable/jenkins.io-2023.key
sudo yum upgrade
sudo yum install jenkins
sudo systemctl daemon-reload
sudo systemctl enable jenkins
sudo systemctl start jenkins
sudo systemctl status jenkins

Pipelines;
Job is nothing but a task
A job has more than one task (a job has multiple tasks)
These task we call as Stages
Pipeline is a sequential execution of multiple stages that are available in a job
Each stage can have multiple steps

Git Checkout	------> Build the Code		-----> Deploy the Code	-----> Access the App
git clone <>				mvn clean
						mvn package

There are two ways of writing a pipeline;
Declarative
	Predefined structure
	Recent and advanced style of writing the pipeline scripts
	Easy to read and manage
	We can write multiple blocks

Scripted
	Groovy language
	Programming
	Hard to read and manage
	It doesn't offer a feature to restart the pipeline from a specific stage

Declarative way of writing the pipelines is most commonly preferred in real-time

pipeline {
    agent any

    tools {
        maven 'maven3'
        jdk 'jdk21'
    }

    environment {
        APP_NAME = "my-app"
    }

    stages {

        stage('Clone Code') {
            steps {
                git 'https://github.com/your-username/your-repo.git'
            }
        }

        stage('Build') {
            steps {
                sh 'mvn clean package -DskipTests'
            }
        }

        stage('Test') {
            steps {
                sh 'mvn test'
            }
        }

        stage('Deploy') {
            steps {
                sh 'echo "Deploying ${APP_NAME}..."'
                // Example:
                // sh 'scp target/*.jar user@server:/opt/apps/'
            }
        }
    }

    post {
        success {
            echo 'Build successful!'
        }
        failure {
            echo 'Build failed!'
        }
        always {
            echo 'Pipeline finished.'
        }
    }
}


======
node {

    def appName = "my-app"

    stage('Clone Code') {
        git 'https://github.com/your-username/your-repo.git'
    }

    stage('Build') {
        sh 'mvn clean package -DskipTests'
    }

    stage('Test') {
        sh 'mvn test'
    }

    stage('Deploy') {
        echo "Deploying ${appName}..."
        // sh 'scp target/*.jar user@server:/opt/apps/'
    }

    stage('Cleanup') {
        cleanWs()
    }
}
===========
Structure of a declarative pipeline;
P	- pipeline
A	- agent any (where you want to store the job information)
S	- stages
S	- steps

All the pipelines will stored in a separate file which is known as "Jenkinsfile"
This Jenkinsfile will be kept in the root path of the repository

==================
Pipeline Project 1
==================
Launch Amazon Linux 2023 AMI

Install Java 21 and Jenkins

Install Maven and Git

Install tomcat (remember the pwd where the tomcat extracted directory is available)

Install Deploy to Container & Pipeline Stageview plugins

Phase 1: Deploy to Tomcat
Stage 1: Get the code
Stage 2: Build the code
Stage 3: Deploy the code

Repo URL: https://github.com/KastroVKiran/Netflix-Pipeline-Project.git

Phase 2:  Download the artifact to my local

Phase 3: Upload the Artifact to S3 Bucket

==> Recovering the deleted job
Job configuration history

Netflix-Project Job ----> Before installing the plugin
recovery-job ----> After installing the plugin

Note: Whatever jobs that were created after installing the plugin only those jobs can be recovered

"thin backup" plugin

==> Login to Jenkins without username and password
config.xml

==> Master and Slave Architecture

worker1

Tasks:
Nexus: https://youtu.be/opJAfDOCZuI?si=6-SdRY0GL62LKlKz

SonarQube: https://youtu.be/ScdedztTaAU?si=D7rPPI21KPQfwICf






















